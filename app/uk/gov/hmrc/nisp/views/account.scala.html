@*
* Copyright 2016 HM Revenue & Customs
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*@

@import uk.gov.hmrc.nisp.utils.Constants
@import uk.gov.hmrc.nisp.views.formatting.{NispMoney, Time}
@import uk.gov.hmrc.play.views.formatting.Dates
@import uk.gov.hmrc.nisp.models.{SPSummaryModel, SPChartModel}
@import uk.gov.hmrc.nisp.services.ABService
@import uk.gov.hmrc.nisp.models.enums.ABTest._
@import uk.gov.hmrc.nisp.controllers.auth.NispUser
@import uk.gov.hmrc.play.partials.CachedStaticHtmlPartialRetriever

@(
    nino: String,
    spSummary: SPSummaryModel,
    abTest: Option[ABTest],
    currentChart: SPChartModel,
    forecastChart: SPChartModel,
    authenticationProvider: String,
    isPertaxUrl:Boolean
)(implicit request: Request[_], user: NispUser, partialRetriever: CachedStaticHtmlPartialRetriever)

@pageScripts = {
<script src="@routes.Assets.at("javascript/account.js")" type="text/javascript"></script>
}

@analyticsAdditionalJs = {
    ga('set', {
        'dimension7':  '@spSummary.contextMessage.getOrElse("")',
        'dimension8':  '@spSummary.forecastAmount.week.toInt',
        @Html(abTest.map (p => s"'dimension9':  '${p.toString}',").getOrElse(""))
        'dimension10': '@spSummary.numberOfQualifyingYears',
        'dimension11': '@spSummary.numberOfGaps',
        'dimension12': '@spSummary.numberOfGapsPayable',
        'dimension13': '@spSummary.yearsToContributeUntilPensionAge',
        'dimension14': '@spSummary.contractedOutFlag',
        'dimension15': '@spSummary.statePensionAge',
        'dimension16': '@spSummary.copeAmount.week',
        'dimension22': '@authenticationProvider',
        'metric5': 1
    });
}

@defining(Some(user)) { implicit userOption =>
    @nispMain(userLoggedIn = true, browserTitle = Messages("nisp.main.title"),
                pageScripts=Some(pageScripts), articleClasses = Some("mainpage"), analyticsAdditionalJs = Some(analyticsAdditionalJs)) {
<h2 class="heading-large">@Messages("nisp.main.h1.title")</h2>
<h3 class="heading-medium subtitle">@Messages("nisp.main.h1.subtitle")</h3>

<div class="highlighted-event">
      <p> @Messages("nisp.main.basedOn") @Dates.formatDate(spSummary.statePensionAge.date.localDate) @Messages("nisp.main.whenYoullBe") @spSummary.statePensionAge.age, @Messages("nisp.main.title.estimate.is")</p>
      <p> <em>@NispMoney.pounds(spSummary.forecastAmount.week) @Messages("nisp.main.week")</em></p>         
      <p> @NispMoney.pounds(spSummary.forecastAmount.month) @Messages("nisp.main.month"),
          @NispMoney.pounds(spSummary.forecastAmount.year) @Messages("nisp.main.year")
     </p>
</div>

        <h1>Here go caveats</h1>
        <h1>Here go charts</h1>
        <h1>Here go personal max messaging</h1>      
    }
}
